(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["Power"],{"47f4":function(t,e,a){},"5f4b":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"Computingpower"},[s("div",{staticClass:"title"},[s("img",{attrs:{src:a("7d1b")},on:{click:function(e){return t.$router.back()}}}),s("span",[t._v(t._s(t.$t("pickuprecord.text4")))])]),s("div",{staticClass:"content"},[s("div",{staticClass:"container"},[s("span",{staticClass:"subtitle"},[t._v(t._s(t.$t("Computingpower.text1")))]),s("div",{staticClass:"middle"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.quantitys,expression:"quantitys"}],attrs:{placeholder:t.$t("Computingpower.text3"),type:"text"},domProps:{value:t.quantitys},on:{input:[function(e){e.target.composing||(t.quantitys=e.target.value)},t.input]}}),s("van-button",{on:{click:t.maximum}},[t._v(t._s(t.$t("Computingpower.text4")))])],1),s("span",{staticClass:"power"},[t._v(t._s(t.$t("Computingpower.text2"))+" "+t._s(t.myPower))]),s("span",{staticClass:"subtitle"},[t._v(t._s(t.$t("Computingpower.text7")))]),s("input",{directives:[{name:"model",rawName:"v-model",value:t.acceptaddress,expression:"acceptaddress"}],attrs:{placeholder:t.$t("Computingpower.text8"),type:"text"},domProps:{value:t.acceptaddress},on:{input:function(e){e.target.composing||(t.acceptaddress=e.target.value)}}}),s("div",{staticClass:"getComputingpower"},[s("div",{directives:[{name:"show",rawName:"v-show",value:t.isshow,expression:"isshow"}],staticClass:"Transferout"},[s("span",[t._v(t._s(t.$t("Computingpower.text5")))]),s("span",[t._v("1%")])]),s("div",{directives:[{name:"show",rawName:"v-show",value:!t.isshow,expression:"!isshow"}],staticClass:"getComputingpower1"},[s("span",[t._v(t._s(t.$t("Computingpower.text6")))]),s("span",[t._v(t._s(t.Available))])])]),s("van-button",{on:{click:t.Transferout}},[t._v(t._s(t.$t("Computingpower.text9")))])],1)]),s("div",{staticClass:"Detail"},[t._v(t._s(t.$t("Computingpower.text10")))]),s("div",{staticClass:"record"},[s("div",{staticClass:"content"},[s("div",[s("span",[t._v(t._s(t.$t("Computingpower.text11")))]),s("span",[t._v(t._s(t.$t("Computingpower.text12")))]),s("span",[t._v(t._s(t.$t("Computingpower.text13")))])]),t._l(t.list,(function(e){return s("div",{key:e,staticClass:"item"},[s("span",[t._v(t._s(e.time))]),s("span",[t._v(t._s(e.type))]),s("span",[t._v(t._s(e.amount))])])}))],2)])])},n=[],r=(a("99af"),a("d81d"),a("a9e3"),a("96cf"),a("1da1")),i=a("044d"),o={data:function(){return{show:!0,isshow:!0,quantitys:"",myPower:0,Available:0,acceptaddress:"",list:[],isStart:!1}},created:function(){this.$contracts&&this.init()},methods:{init:function(){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:a=new t.$web3.BatchRequest,a.add(t.$contracts.Mine.methods.isStart().call.request({from:t.$address})),a.add(t.$contracts.Mine.methods.mineInfo().call.request({from:t.$address})),a.add(t.$contracts.Pledge.methods.getMinerInfo(0).call.request({from:t.$address})),a.add(t.$contracts.Shareholders.methods.pledgeInfo(t.$address).call.request({from:t.$address})),a.requestManager.sendBatch(a.requests,(function(e,a){if(!e){var s=a[1].result.decode([{name:"myPower",type:"uint256"},{name:"mined",type:"uint256"}]),n=s.myPower,r=a[2].result.decode([{name:"pledgeLp",type:"uint256"},{name:"gainPower",type:"uint256"}]),i=r.gainPower,o=a[3].result.decode([{name:"lpAmount",type:"uint256"},{name:"totalPower",type:"uint256"},{name:"lpAmountPerUSD",type:"uint256"},{name:"lpAmountPerPIN",type:"uint256"}]),u=o.totalPower;t.isStart=("string"===typeof a[0]?a[0]:a[0].result).decode(["bool"]),t.myPower=Number(n)-Number(i)-Number(u)}})),Object(i["c"])(t.$address).then((function(e){t.list=e.map((function(e){var a=e.isAdd?"+":"-",s="";switch(e.powerSource){case"Transfer":s=t.$t("Computingpower.text1".concat(e.isAdd?9:8));break;case"Pledge":s=t.$t("Computingpower.text".concat(e.isAdd?16:20));break;case"Community":s="DAO";break;case"Share":s=t.$t("Computingpower.text15");break;case"Holder":s=t.$t("Computingpower.text2".concat(e.isAdd?6:7));break}return{type:s,amount:"".concat(a).concat(e.amount),time:t.$toTime(e.time,"Y/M/D")}}))}));case 7:case"end":return e.stop()}}),e)})))()},maximum:function(){this.quantitys=this.myPower,this.input()},input:function(){var t=parseInt(this.quantitys,10);t!=this.quantitys?(this.quantitys="",this.isshow=!0):null!=this.quantitys&&(this.isshow=!1),this.Available=Math.floor(.99*this.quantitys)},Transferout:function(){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function e(){var a,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.isStart){e.next=4;break}return e.abrupt("return",vant.Toast.fail("合约暂未生效！"));case 4:if(!(Number(t.quantitys)<=0)){e.next=8;break}return e.abrupt("return",vant.Toast.fail(t.$t("Computingpower.text21")));case 8:if(!(Number(t.quantitys)>Number(t.myPower))){e.next=12;break}return e.abrupt("return",vant.Toast.fail(t.$t("Computingpower.text22")));case 12:if(!t.quantitys.toBN().lt(100)){e.next=16;break}return e.abrupt("return",vant.Toast.fail("算力转出最低为100！"));case 16:if(t.$web3.utils.isAddress(t.acceptaddress)){e.next=18;break}return e.abrupt("return",vant.Toast.fail(t.$t("Computingpower.text23")));case 18:return e.next=20,t.$contracts.Friends.methods.parentOf(t.acceptaddress).call({from:t.$address});case 20:if(a=e.sent,!a.toBN().lte(0)){e.next=23;break}return e.abrupt("return",vant.Toast.fail("接收地址未激活！"));case 23:s=t.$contracts.Mine.methods.transfer(t.acceptaddress,t.quantitys),s.call({from:t.$address},(function(e,a){e||s.send({from:t.$address}).on("transactionHash",(function(e){vant.Toast.loading({message:t.$t("transaction.text7"),forbidClick:!0,duration:0,loadingType:"spinner"})})).on("receipt",(function(e){t.init(),vant.Toast.clear(),t.acceptaddress="",t.quantitys="",t.isshow=!0,vant.Toast.success(t.$t("Computingpower.text25"))})).on("error",(function(e){vant.Toast.clear(),vant.Toast.fail(t.$t("transaction.text13"))}))}));case 25:case"end":return e.stop()}}),e)})))()}}},u=o,c=u,p=(a("eefa"),a("2877")),d=Object(p["a"])(c,s,n,!1,null,"bee8d494",null);e["default"]=d.exports},"7d1b":function(t,e,a){t.exports=a.p+"img/back.1028a30c.svg"},eefa:function(t,e,a){"use strict";a("47f4")}}]);